
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>开始使用Java Lambda表达式 - 安迪的博客</title>
  <meta name="author" content="安迪">

  
  <meta name="description" content="简介 Lambda表达式是Java SE 8中一个全新和重要的特性。Lambda表达式提供一种通过使用表达式来表述方法的方式。Lambda表达式和一个方法一样，拥有一个形参列表和一个参考这些形参的方法体（可以是一个表达式或者一个代码块）。 此外，Lambda表达式也增强了集合类库。Java SE &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://renhai.github.io/blog/2014/07/04/start-using-java-lambda-expressions">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
   
  <link href="/atom.xml" rel="alternate" title="安迪的博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://cdn.staticfile.org/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script type="text/javascript">
function addBlankTargetForLinks () {
  $('a[href^="http"]').each(function(){
      $(this).attr('target', '_blank');
  });
}

$(document).bind('DOMNodeInserted', function(event) {
  addBlankTargetForLinks();
});
</script>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">安迪的博客</a></h1>
  
    <h2>态度决定一切</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:renhai.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">开始使用Java Lambda表达式</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-04T17:46:05+08:00" pubdate data-updated="true">Jul 4<sup>th</sup>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><h3>简介</h3>

<hr />

<p>Lambda表达式是Java SE 8中一个全新和重要的特性。Lambda表达式提供一种通过使用表达式来表述方法的方式。Lambda表达式和一个方法一样，拥有一个形参列表和一个参考这些形参的方法体（可以是一个表达式或者一个代码块）。</p>

<p>此外，Lambda表达式也增强了集合类库。Java SE 8为集合类库增加了两个批量数据操作相关的package：java.util.function和java.util.stream。stream类似于iterator，但是提供了更多的功能。总之，Lambda表达式和stream是自泛型和注解被添加到Java语言之后最大的一个改变。在这篇文章中，我们将要由浅入深的探索Lambda表达式和stream的强大。</p>

<!--more-->


<h3>前期准备</h3>

<hr />

<p>在开始使用lambda和stream之前，你需要确保安装Java 8。NetBeans和IntelliJ IDEA这些工具支持Java 8的特性，例如：lambda表达式，repeatable annotations， compact profiles等等。</p>

<p>以下提供了Java SE 8和NetBeans IDE 8的下载链接地址：</p>

<ul>
<li><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Platform(JDK 8)</a>：从Oracle官网下载Java 8，也可以下载捆绑了NetBeans IDE 版本。</p></li>
<li><p><a href="https://netbeans.org/downloads/index.html">NetBeans IDE 8</a>：从NetBeans官网下载NetBeans IDE。</p></li>
</ul>


<h3>Lambda表达式语法</h3>

<hr />

<p>lambda基本语法：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(parameters) -&gt;expression</span></code></pre></td></tr></table></div></figure>


<p>或者</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> (parameters) -&gt;{ statements; }</span></code></pre></td></tr></table></div></figure>


<p>以下是Lambda表达式的几个例子：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>() -&gt; 5                                   // takes no value and returns 5
</span><span class='line'>x -&gt; 2 * x                             // takes a number and returns the result of doubling it
</span><span class='line'>(x, y) -&gt; x – y                          // takes two numbers and returns their difference
</span><span class='line'>(int x, int y) -&gt; x + y                    // takes two integers and returns their sum
</span><span class='line'>(String s) -&gt; System.out.print(s)      // takes a string and prints it to console without returning anything</span></code></pre></td></tr></table></div></figure>


<h3>基本的Lambda表达式例子</h3>

<hr />

<p>现在我们大概了解了什么是lambda表达式，让我们从一些简单的例子开始学习。在这个部分，我们将会看到lambda表达式如何影响我们编程的方式。假设我们有一个player的列表，程序猿经常使用的for循环在Java SE 8中可以转换成如下方式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>String[] atp = {"Rafael Nadal", "Novak Djokovic", "Stanislas Wawrinka", "David Ferrer", "Roger Federer", "Andy Murray", "Tomas Berdych", "Juan Martin Del Potro"};
</span><span class='line'>List&lt;String&gt; players =  Arrays.asList(atp);
</span><span class='line'>       
</span><span class='line'>// Old looping
</span><span class='line'>for (String player : players) {
</span><span class='line'>     System.out.print(player + "; ");
</span><span class='line'>}
</span><span class='line'>       
</span><span class='line'>// Using lambda expression and functional operations
</span><span class='line'>players.forEach((player) -&gt; System.out.print(player + "; "));
</span><span class='line'> 
</span><span class='line'>// Using double colon operator in Java 8
</span><span class='line'>players.forEach(System.out::println);</span></code></pre></td></tr></table></div></figure>


<p>正如你看到的，lambda表达式可以将我们的代码精简到一行。另外的一个例子是在用户图形界面应用中，匿名类可以被Lambda表达式替换。此外实现一个Runnable接口是也是如此：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Using anonymous innerclass
</span><span class='line'>btn.setOnAction(new EventHandler&lt;ActionEvent&gt;() {
</span><span class='line'>              @Override
</span><span class='line'>              public void handle(ActionEvent event) {
</span><span class='line'>                  System.out.println("Hello World!"); 
</span><span class='line'>            }
</span><span class='line'>        });
</span><span class='line'> 
</span><span class='line'>// Using lambda expression
</span><span class='line'>btn.setOnAction(event -&gt; System.out.println("Hello World!"));
</span><span class='line'> 
</span><span class='line'>Here is how we can write a Runnable using lambdas:
</span><span class='line'>
</span><span class='line'>// Using anonymous innerclass 
</span><span class='line'>new Thread(new Runnable() {
</span><span class='line'>  @Override
</span><span class='line'>  public void run() {
</span><span class='line'>      System.out.println("Hello world !");
</span><span class='line'>  }
</span><span class='line'>}).start();
</span><span class='line'> 
</span><span class='line'>// Using lambda expression
</span><span class='line'>new Thread(() -&gt; System.out.println("Hello world !")).start();
</span><span class='line'> 
</span><span class='line'>// Using anonymous innerclass
</span><span class='line'>Runnable race1 = new Runnable() {
</span><span class='line'>  @Override
</span><span class='line'>  public void run() {
</span><span class='line'>      System.out.println("Hello world !");
</span><span class='line'>  }
</span><span class='line'>};
</span><span class='line'> 
</span><span class='line'>// Using lambda expression
</span><span class='line'>Runnable race2 = () -&gt; System.out.println("Hello world !");
</span><span class='line'> 
</span><span class='line'>// Run em!
</span><span class='line'>race1.run();
</span><span class='line'>race2.run();</span></code></pre></td></tr></table></div></figure>


<p>Runnable使用lambda表达式之后可以将5行代码转换成1行，接下来，我们将在集合类排序中使用Lambda。</p>

<h3>使用Lambda对Collection排序</h3>

<hr />

<p>在Java中，我们通常使用Comparator类来进行集合类排序。在接下来的例子中，我们将根据name，surname，name length和last name letter来对player list排序。首先我们使用之前的方式及匿名内部类的方式进行排序，然后我们使用lambda表达式的方式。</p>

<p>第一个例子，我们使用之前的方式，根据name排序，如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>String[] players = {"Rafael Nadal", "Novak Djokovic", "Stanislas Wawrinka", "David Ferrer", "Roger Federer", "Andy Murray", "Tomas Berdych", "Juan Martin Del Potro", "Richard Gasquet", "John Isner"};
</span><span class='line'> 
</span><span class='line'>// Sort players by name using anonymous innerclass
</span><span class='line'>Arrays.sort(players, new Comparator&lt;String&gt;() {
</span><span class='line'>  @Override
</span><span class='line'>  public int compare(String s1, String s2) {
</span><span class='line'>      return (s1.compareTo(s2));
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>使用lambda可以达到相同的效果：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Sort players by name using lambda expression
</span><span class='line'>Comparator&lt;String&gt; sortByName = (String s1, String s2) -&gt; (s1.compareTo(s2));
</span><span class='line'> 
</span><span class='line'>Arrays.sort(players, sortByName);
</span><span class='line'>// or this
</span><span class='line'>Arrays.sort(players, (String s1, String s2) -&gt; (s1.compareTo(s2)));</span></code></pre></td></tr></table></div></figure>


<p>下面是根据其他字段的排序，和上面的例子一样，代码中使用了匿名内部类和lambda表达式两种方式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Sort players by surname using anonymous innerclass
</span><span class='line'>Arrays.sort(players, new Comparator&lt;String&gt;() {
</span><span class='line'>  @Override
</span><span class='line'>  public int compare(String s1, String s2) {
</span><span class='line'>      return (s1.substring(s1.indexOf(" ")).compareTo(s2.substring(s2.indexOf(" "))));
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'> 
</span><span class='line'>// Sort players by surname using lambda expression
</span><span class='line'>Comparator&lt;String&gt; sortBySurname = (String s1, String s2) -&gt; (s1.substring(s1.indexOf(" ")).compareTo(s2.substring(s2.indexOf(" "))));
</span><span class='line'> 
</span><span class='line'>Arrays.sort(players, sortBySurname);
</span><span class='line'>// or this
</span><span class='line'>Arrays.sort(players, (String s1, String s2) -&gt; (s1.substring(s1.indexOf(" ")).compareTo(s2.substring(s2.indexOf(" ")))));
</span><span class='line'> 
</span><span class='line'>// Sort players by name lenght using anonymous innerclass
</span><span class='line'>Arrays.sort(players, new Comparator&lt;String&gt;() {
</span><span class='line'>  @Override
</span><span class='line'>  public int compare(String s1, String s2) {
</span><span class='line'>      return (s1.length() - s2.length());
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'> 
</span><span class='line'>// Sort players by name lenght using lambda expression
</span><span class='line'>Comparator&lt;String&gt; sortByNameLenght = (String s1, String s2) -&gt; (s1.length() - s2.length());
</span><span class='line'> 
</span><span class='line'>Arrays.sort(players, sortByNameLenght);
</span><span class='line'>// or this
</span><span class='line'>Arrays.sort(players, (String s1, String s2) -&gt; (s1.length() - s2.length()));
</span><span class='line'> 
</span><span class='line'>// Sort players by last letter using anonymous innerclass
</span><span class='line'>Arrays.sort(players, new Comparator&lt;String&gt;() {
</span><span class='line'>  @Override
</span><span class='line'>  public int compare(String s1, String s2) {
</span><span class='line'>      return (s1.charAt(s1.length() - 1) - s2.charAt(s2.length() - 1));
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'> 
</span><span class='line'>// Sort players by last letter using lambda expression
</span><span class='line'>Comparator&lt;String&gt; sortByLastLetter = (String s1, String s2) -&gt; (s1.charAt(s1.length() - 1) - s2.charAt(s2.length() - 1));
</span><span class='line'>Arrays.sort(players, sortByLastLetter);
</span><span class='line'>// or this
</span><span class='line'>Arrays.sort(players, (String s1, String s2) -&gt; (s1.charAt(s1.length() - 1) - s2.charAt(s2.length() - 1)));</span></code></pre></td></tr></table></div></figure>


<p>就是这样，非常得简单明确。在下一节，我们将会探索更多的lambda表达式功能&mdash;同stream混合使用。</p>

<h3>混合使用Lambda和Stream</h3>

<hr />

<p>Stream是对集合类的又一次包装，其中大量使用Lambda表达式。Stream支持多种操作，例如map，filter，limit，sorted，count，min，max，sum，collect等等。另外，Stream使用惰性计算方式，并不是读取全部数据，像getFirst()这种方法可以结束stream。在下一个例子中，我们将要探索lambda和stream能够做什么。我们创建了一个Person类，并向一个list中添加Person，在接下来的stream操作中将会使用这个list。Person类是一个简单的POJO:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class Person {
</span><span class='line'> 
</span><span class='line'>private String firstName, lastName, job, gender;
</span><span class='line'>private int salary, age;
</span><span class='line'> 
</span><span class='line'>public Person(String firstName, String lastName, String job, String gender, int age, int salary)       {
</span><span class='line'>          this.firstName = firstName;
</span><span class='line'>          this.lastName = lastName;
</span><span class='line'>          this.gender = gender;
</span><span class='line'>          this.age = age;
</span><span class='line'>          this.job = job;
</span><span class='line'>          this.salary = salary;
</span><span class='line'>}
</span><span class='line'>// Getter and Setter 
</span><span class='line'>. . . . .   
</span><span class='line'>}   </span></code></pre></td></tr></table></div></figure>


<p>接下来，创建2个都包含Person对象的list:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>        
</span><span class='line'>    List&lt;Person&gt; javaProgrammers = new ArrayList&lt;Person&gt;() {
</span><span class='line'>        {
</span><span class='line'>            add(new Person("Elsdon", "Jaycob", "Java programmer", "male", 43, 2000));
</span><span class='line'>            add(new Person("Tamsen", "Brittany", "Java programmer", "female", 23, 1500));
</span><span class='line'>            add(new Person("Floyd", "Donny", "Java programmer", "male", 33, 1800));
</span><span class='line'>            add(new Person("Sindy", "Jonie", "Java programmer", "female", 32, 1600));
</span><span class='line'>            add(new Person("Vere", "Hervey", "Java programmer", "male", 22, 1200));
</span><span class='line'>            add(new Person("Maude", "Jaimie", "Java programmer", "female", 27, 1900));
</span><span class='line'>            add(new Person("Shawn", "Randall", "Java programmer", "male", 30, 2300));
</span><span class='line'>            add(new Person("Jayden", "Corrina", "Java programmer", "female", 35, 1700));
</span><span class='line'>            add(new Person("Palmer", "Dene", "Java programmer", "male", 33, 2000));
</span><span class='line'>            add(new Person("Addison", "Pam", "Java programmer", "female", 34, 1300));
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'> 
</span><span class='line'>    List&lt;Person&gt; phpProgrammers = new ArrayList&lt;Person&gt;() {
</span><span class='line'>        {
</span><span class='line'>            add(new Person("Jarrod", "Pace", "PHP programmer", "male", 34, 1550));
</span><span class='line'>            add(new Person("Clarette", "Cicely", "PHP programmer", "female", 23, 1200));
</span><span class='line'>            add(new Person("Victor", "Channing", "PHP programmer", "male", 32, 1600));
</span><span class='line'>            add(new Person("Tori", "Sheryl", "PHP programmer", "female", 21, 1000));
</span><span class='line'>            add(new Person("Osborne", "Shad", "PHP programmer", "male", 32, 1100));
</span><span class='line'>            add(new Person("Rosalind", "Layla", "PHP programmer", "female", 25, 1300));
</span><span class='line'>            add(new Person("Fraser", "Hewie", "PHP programmer", "male", 36, 1100));
</span><span class='line'>            add(new Person("Quinn", "Tamara", "PHP programmer", "female", 21, 1000));
</span><span class='line'>            add(new Person("Alvin", "Lance", "PHP programmer", "male", 38, 1600));
</span><span class='line'>            add(new Person("Evonne", "Shari", "PHP programmer", "female", 40, 1800));
</span><span class='line'>        }
</span><span class='line'>    };</span></code></pre></td></tr></table></div></figure>


<p>现在我们使用forEach方法来遍历上面的list：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Show programmers names:");
</span><span class='line'>javaProgrammers.forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));
</span><span class='line'>phpProgrammers.forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));</span></code></pre></td></tr></table></div></figure>


<p>下面我们使用同样的forEach方法将programmer的salary增加5%：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Increase salary by 5% to programmers:");
</span><span class='line'>Consumer&lt;Person&gt; giveRaise = e -&gt; e.setSalary(e.getSalary() / 100 * 5 + e.getSalary());
</span><span class='line'> 
</span><span class='line'>javaProgrammers.forEach(giveRaise);
</span><span class='line'>phpProgrammers.forEach(giveRaise);</span></code></pre></td></tr></table></div></figure>


<p>另外一个实用的方法是filter方法。为了展示如何使用filter，我们打印一下salary超过$1,400的PHP programmer：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Show PHP programmers that earn more than $1,400:")
</span><span class='line'>phpProgrammers.stream()
</span><span class='line'>          .filter((p) -&gt; (p.getSalary() &gt; 1400))
</span><span class='line'>          .forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));</span></code></pre></td></tr></table></div></figure>


<p>此外，我们可以预先定义filter，以便在接下来的操作中重用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Define some filters
</span><span class='line'>Predicate&lt;Person&gt; ageFilter = (p) -&gt; (p.getAge() &gt; 25);
</span><span class='line'>Predicate&lt;Person&gt; salaryFilter = (p) -&gt; (p.getSalary() &gt; 1400);
</span><span class='line'>Predicate&lt;Person&gt; genderFilter = (p) -&gt; ("female".equals(p.getGender()));
</span><span class='line'> 
</span><span class='line'>System.out.println("Show female PHP programmers that earn more than $1,400 and are older than 24 years:");
</span><span class='line'>phpProgrammers.stream()
</span><span class='line'>          .filter(ageFilter)
</span><span class='line'>          .filter(salaryFilter)
</span><span class='line'>          .filter(genderFilter)
</span><span class='line'>          .forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));
</span><span class='line'> 
</span><span class='line'>// Reuse filters
</span><span class='line'>System.out.println("Show female Java programmers older than 24 years:");
</span><span class='line'>javaProgrammers.stream()
</span><span class='line'>          .filter(ageFilter)
</span><span class='line'>          .filter(genderFilter)
</span><span class='line'>          .forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));</span></code></pre></td></tr></table></div></figure>


<p>我们可以使用limit方法来限制结果数量：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Show first 3 Java programmers:");
</span><span class='line'>javaProgrammers.stream()
</span><span class='line'>          .limit(3)
</span><span class='line'>          .forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));
</span><span class='line'> 
</span><span class='line'>System.out.println("Show first 3 female Java programmers:");
</span><span class='line'>javaProgrammers.stream()
</span><span class='line'>          .filter(genderFilter)
</span><span class='line'>          .limit(3)
</span><span class='line'>          .forEach((p) -&gt; System.out.printf("%s %s; ", p.getFirstName(), p.getLastName()));</span></code></pre></td></tr></table></div></figure>


<p>我们可以使用stream进行排序吗？当然可以。在下面的例子中，我们将根据name，salary对Java programmer进行排序，并将结果添加到一个list中，最后打印这个list:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Sort and show the first 5 Java programmers by name:");
</span><span class='line'>List&lt;Person&gt; sortedJavaProgrammers = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .sorted((p, p2) -&gt; (p.getFirstName().compareTo(p2.getFirstName())))
</span><span class='line'>          .limit(5)
</span><span class='line'>          .collect(toList());
</span><span class='line'> 
</span><span class='line'>sortedJavaProgrammers.forEach((p) -&gt; System.out.printf("%s %s; %n", p.getFirstName(), p.getLastName()));
</span><span class='line'> 
</span><span class='line'>System.out.println("Sort and show Java programmers by salary:");
</span><span class='line'>sortedJavaProgrammers = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .sorted((p, p2) -&gt; (p.getSalary() - p2.getSalary()))
</span><span class='line'>          .collect(toList());
</span><span class='line'> 
</span><span class='line'>sortedJavaProgrammers.forEach((p) -&gt; System.out.printf("%s %s; %n", p.getFirstName(), p.getLastName()));</span></code></pre></td></tr></table></div></figure>


<p>如果只对最低和最高salary感兴趣，我们可以先进行排序，然后取fist或者last，比这种方式更快的是使用min和max方法:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Get the lowest Java programmer salary:");
</span><span class='line'>Person pers = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .min((p1, p2) -&gt; (p1.getSalary() - p2.getSalary()))
</span><span class='line'>          .get()
</span><span class='line'> 
</span><span class='line'>System.out.printf("Name: %s %s; Salary: $%,d.", pers.getFirstName(), pers.getLastName(), pers.getSalary())
</span><span class='line'> 
</span><span class='line'>System.out.println("Get the highest Java programmer salary:");
</span><span class='line'>Person person = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .max((p, p2) -&gt; (p.getSalary() - p2.getSalary()))
</span><span class='line'>          .get()
</span><span class='line'> 
</span><span class='line'>System.out.printf("Name: %s %s; Salary: $%,d.", person.getFirstName(), person.getLastName(), person.getSalary())</span></code></pre></td></tr></table></div></figure>


<p>通过上面的例子，我们已经看到了collect method是如何使用的。结合map method，我们使用collect method将结果转化成一个String，Set或者是TreeSet：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Get PHP programmers first name to String:");
</span><span class='line'>String phpDevelopers = phpProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .map(Person::getFirstName)
</span><span class='line'>          .collect(joining(" ; "));    // this can be used as a token in further operations
</span><span class='line'> 
</span><span class='line'>System.out.println("Get Java programmers first name to Set:");
</span><span class='line'>Set&lt;String&gt; javaDevFirstName = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .map(Person::getFirstName)
</span><span class='line'>          .collect(toSet());
</span><span class='line'> 
</span><span class='line'>System.out.println("Get Java programmers last name to TreeSet:");
</span><span class='line'>TreeSet&lt;String&gt; javaDevLastName = javaProgrammers
</span><span class='line'>          .stream()
</span><span class='line'>          .map(Person::getLastName)
</span><span class='line'>          .collect(toCollection(TreeSet::new));</span></code></pre></td></tr></table></div></figure>


<p>Stream也可以是并行的，例如：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>System.out.println("Calculate total money spent for paying Java programmers:");
</span><span class='line'>int totalSalary = javaProgrammers
</span><span class='line'>          .parallelStream()
</span><span class='line'>          .mapToInt(p -&gt; p.getSalary())
</span><span class='line'>          .sum();</span></code></pre></td></tr></table></div></figure>


<p>为了获取stream中元素的各种统计数据，我们可以使用summaryStatistics method，然后调用getMax, getMin, getSum or getAverage这些方法：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//Get count, min, max, sum, and average for numbers
</span><span class='line'>List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
</span><span class='line'>IntSummaryStatistics stats = numbers
</span><span class='line'>          .stream()
</span><span class='line'>          .mapToInt((x) -&gt; x)
</span><span class='line'>          .summaryStatistics();
</span><span class='line'> 
</span><span class='line'>System.out.println("Highest number in List : " + stats.getMax());
</span><span class='line'>System.out.println("Lowest number in List : " + stats.getMin());
</span><span class='line'>System.out.println("Sum of all numbers : " + stats.getSum());
</span><span class='line'>System.out.println("Average of all numbers : " + stats.getAverage());</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s all, 希望大家喜欢。</p>

<h3>总结</h3>

<hr />

<p>在这篇文章中，我们探讨了lambda表达式的多种使用方式，从简单的例子到复杂的例子，其中我们学习了如何在stream中使用lambda。此外，我们还学习了如何使用lambda表达式对collection进行排序。</p>

<p><a href="http://www.jguru.com/article/core/start-using-java-lambda-expressions.html">原文链接</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">安迪</span></span>

      








  


<time datetime="2014-07-04T17:46:05+08:00" pubdate data-updated="true">Jul 4<sup>th</sup>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>java</a>, <a class='category' href='/blog/categories/java8/'>java8</a>, <a class='category' href='/blog/categories/lambda/'>lambda</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  

  
    <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
  

</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/06/26/ios-common-macro/" title="Previous Post: iOS开发中一些常用的宏定义">&laquo; iOS开发中一些常用的宏定义</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/07/25/mysql-delete-duplicate/" title="Next Post: MySQL删除重复记录">MySQL删除重复记录 &raquo;</a>
      
    </p>
  </footer>
</article>



<section>
    <h1>评论</h1>
    <div id="comments" aria-live="polite"><!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="/blog/2014/07/04/start-using-java-lambda-expressions" data-title="开始使用Java Lambda表达式"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"renhai"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->

</div>
</section>


</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/08/22/my-maven-settings/">我的Maven settings.xml</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/19/linux-shell-scripting-cookbook-note1/">Linux Shell脚本攻略学习笔记1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/25/mysql-delete-duplicate/">MySQL删除重复记录</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/04/start-using-java-lambda-expressions/">开始使用Java Lambda表达式</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/26/ios-common-macro/">iOS开发中一些常用的宏定义</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/bash/'>bash (1)</a></li>
<li class='category'><a href='/blog/categories/git/'>git (1)</a></li>
<li class='category'><a href='/blog/categories/ios/'>ios (3)</a></li>
<li class='category'><a href='/blog/categories/java/'>java (1)</a></li>
<li class='category'><a href='/blog/categories/java8/'>java8 (1)</a></li>
<li class='category'><a href='/blog/categories/lambda/'>lambda (1)</a></li>
<li class='category'><a href='/blog/categories/linux/'>linux (1)</a></li>
<li class='category'><a href='/blog/categories/maven/'>maven (1)</a></li>
<li class='category'><a href='/blog/categories/mysql/'>mysql (1)</a></li>
<li class='category'><a href='/blog/categories/nginx/'>nginx (1)</a></li>
<li class='category'><a href='/blog/categories/objective-c/'>objective-c (1)</a></li>
<li class='category'><a href='/blog/categories/shell/'>shell (2)</a></li>

  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/renhai">@renhai</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'renhai',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - 安迪 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
